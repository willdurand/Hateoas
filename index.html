<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Hateoas by willdurand</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Hateoas</h1>
      <h2 class="project-tagline">A PHP library to support implementing representations for HATEOAS REST web services.</h2>
      <a href="https://github.com/willdurand/Hateoas" class="btn">View on GitHub</a>
      <a href="https://github.com/willdurand/Hateoas/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/willdurand/Hateoas/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="hateoas" class="anchor" href="#hateoas" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Hateoas</h1>

<p><a href="http://travis-ci.org/willdurand/Hateoas"><img src="https://secure.travis-ci.org/willdurand/Hateoas.png" alt="Build
Status"></a>
<a href="https://scrutinizer-ci.com/g/willdurand/Hateoas/"><img src="https://scrutinizer-ci.com/g/willdurand/Hateoas/badges/quality-score.png?s=45b5a825f99de4d29c98b5103f59e060139cf354" alt="Scrutinizer Quality
Score"></a>
<a href="https://packagist.org/packages/willdurand/hateoas"><img src="https://poser.pugx.org/willdurand/hateoas/v/stable.png" alt="Latest Stable
Version"></a>
<img src="https://img.shields.io/badge/PHP7-ready-green.svg" alt="PHP7 ready"></p>

<p>A PHP library to support implementing representations for HATEOAS REST web
services.</p>

<ul>
<li>
<a href="#installation">Installation</a>

<ul>
<li><a href="#working-with-symfony2">Working With Symfony2</a></li>
</ul>
</li>
<li>
<a href="#usage">Usage</a>

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#configuring-links">Configuring Links</a></li>
<li><a href="#embedding-resources">Embedding Resources</a></li>
<li><a href="#dealing-with-collections">Dealing With Collections</a></li>
<li>
<a href="#representations">Representations</a>

<ul>
<li><a href="#vnderrorrepresentation">VndErrorRepresentation</a></li>
</ul>
</li>
<li>
<a href="#the-expression-language">The Expression Language</a>

<ul>
<li><a href="#context">Context</a></li>
<li><a href="#adding-your-own-context-variables">Adding Your Own Context Variables</a></li>
<li><a href="#expression-functions">Expression Functions</a></li>
</ul>
</li>
<li><a href="#url-generators">URL Generators</a></li>
<li>
<a href="#helpers">Helpers</a>

<ul>
<li><a href="#linkhelper">LinkHelper</a></li>
</ul>
</li>
<li>
<a href="#twig-extensions">Twig Extensions</a>

<ul>
<li><a href="#linkextension">LinkExtension</a></li>
</ul>
</li>
<li>
<a href="#serializers--formats">Serializers &amp; Formats</a>

<ul>
<li><a href="#the-jsonhalserializer">The JsonHalSerializer</a></li>
<li><a href="#the-xmlserializer">The XmlSerializer</a></li>
<li><a href="#the-xmlhalserializer">The XmlHalSerializer</a></li>
<li><a href="#adding-new-serializers">Adding New Serializers</a></li>
</ul>
</li>
<li>
<a href="#the-hateoasbuilder">The HateoasBuilder</a>

<ul>
<li><a href="#xml-serializer">XML Serializer</a></li>
<li><a href="#json-serializer">JSON Serializer</a></li>
<li><a href="#url-generator">URL Generator</a></li>
<li><a href="#expression-evaluatorexpression-language">Expression Evaluator/Expression Language</a></li>
<li><a href="#relation-provider">Relation Provider</a></li>
<li><a href="#jms-serializer-specific">(JMS) Serializer Specific</a></li>
<li><a href="#others">Others</a></li>
</ul>
</li>
<li><a href="#configuring-a-cache-directory">Configuring a Cache Directory</a></li>
<li><a href="#configuring-metadata-locations">Configuring Metadata Locations</a></li>
<li><a href="#extending-the-library">Extending The Library</a></li>
</ul>
</li>
<li>
<a href="#reference">Reference</a>

<ul>
<li><a href="#xml">XML</a></li>
<li><a href="#yaml">YAML</a></li>
<li>
<a href="#annotations">Annotations</a>

<ul>
<li><a href="#relation">@Relation</a></li>
<li><a href="#route">@Route</a></li>
<li><a href="#embedded">@Embedded</a></li>
<li><a href="#exclusion">@Exclusion</a></li>
<li><a href="#relationprovider">@RelationProvider</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#internals">Internals</a></li>
</ul>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p>The recommended way to install Hateoas is through
<a href="http://getcomposer.org/">Composer</a>. Require the <code>willdurand/hateoas</code> package
by running the following command:</p>

<div class="highlight highlight-source-shell"><pre>composer require willdurand/hateoas</pre></div>

<p>This will resolve the latest stable version.</p>

<p>Otherwise, install the library and setup the autoloader yourself.</p>

<h3>
<a id="working-with-symfony2" class="anchor" href="#working-with-symfony2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Working With Symfony2</h3>

<p>There is a bundle for that! Install the
<a href="https://github.com/willdurand/BazingaHateoasBundle">BazingaHateoasBundle</a>, and
enjoy!</p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h2>

<blockquote>
<p><strong>Important:</strong> For those who use the <code>1.0</code> version, you can <a href="https://github.com/willdurand/Hateoas/blob/1.0/README.md#readme">jump to this
documentation
page</a> as the
following documentation has been written for <strong>Hateoas 2.0</strong> and above.</p>
</blockquote>

<h3>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h3>

<p><strong>Hateoas</strong> leverages the <a href="https://github.com/schmittjoh/serializer">Serializer</a>
library to provide a nice way to build HATEOAS REST web services. HATEOAS stands
for <strong>Hypermedia as the Engine of Application State</strong>,
and adds <strong>hypermedia links</strong> to your <strong>representations</strong> (i.e. your API
responses). <a href="http://timelessrepo.com/haters-gonna-hateoas">HATEOAS is about the discoverability of actions on a
resource</a>.</p>

<p>For instance, let's say you have a User API which returns a <strong>representation</strong>
of a single <em>user</em> as follow:</p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>user<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-c1">123</span>,
        <span class="pl-s"><span class="pl-pds">"</span>first_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>John<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>last_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Doe<span class="pl-pds">"</span></span>
    }
}</pre></div>

<p>In order to tell your API consumers how to retrieve the data for this specific
user, you have to add your very first <strong>link</strong> to this representation, let's
call it <code>self</code> as it is the URI for this particular user:</p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>user<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-c1">123</span>,
        <span class="pl-s"><span class="pl-pds">"</span>first_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>John<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>last_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Doe<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: { <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://example.com/api/users/123<span class="pl-pds">"</span></span> }
        }
    }
}</pre></div>

<p>Let's dig into Hateoas now.</p>

<h3>
<a id="configuring-links" class="anchor" href="#configuring-links" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuring Links</h3>

<p>In Hateoas terminology, <strong>links</strong> are seen as <strong>relations</strong> added to resources.
It is worth mentioning that <strong>relations</strong> also refer to <strong>embedded resources</strong>
too, but this topic will be covered in the <a href="#embedding-resources">Embedding
Resources</a> section.</p>

<p>A link is a relation which is identified by a <code>name</code> (e.g. <code>self</code>) and that
has an <code>href</code> parameter:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">JMS\Serializer\Annotation</span> <span class="pl-k">as</span> <span class="pl-c1">Serializer</span>;</span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration\Annotation</span> <span class="pl-k">as</span> <span class="pl-c1">Hateoas</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * @Serializer\XmlRoot("user")</span></span>
<span class="pl-s1"><span class="pl-c"> *</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation("self", href = "expr('/api/users/' ~ object.getId())")</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">User</span></span>
<span class="pl-s1">{</span>
<span class="pl-s1">    <span class="pl-c">/** @Serializer\XmlAttribute */</span></span>
<span class="pl-s1">    <span class="pl-k">private</span> <span class="pl-smi">$id</span>;</span>
<span class="pl-s1">    <span class="pl-k">private</span> <span class="pl-smi">$firstName</span>;</span>
<span class="pl-s1">    <span class="pl-k">private</span> <span class="pl-smi">$lastName</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">getId</span>() {}</span>
<span class="pl-s1">}</span></pre></div>

<p>In the example above, we configure a <code>self</code> relation that is a link because of
the <code>href</code> parameter. Its value, which may look weird at first glance, will be
extensively covered in <a href="#the-expression-language">The Expression Language</a>
section. This special value is used to generate a URI.</p>

<p>In this section, <a href="#annotations"><strong>annotations</strong></a> are used to configure Hateoas.
<a href="#xml"><strong>XML</strong></a> and <a href="#yaml"><strong>YAML</strong></a> formats are also supported. If you wish,
you can use plain PHP too.</p>

<p><strong>Important:</strong> you must configure both the Serializer and Hateoas the same way. E.g.
if you use YAML for configuring Serializer, use YAML for configuring Hateoas.</p>

<p>The easiest way to try HATEOAS is with the <code>HateoasBuilder</code>. The builder has
numerous methods to configure the Hateoas serializer, but we won't dig into
them right now (see <a href="#the-hateoasbuilder">The HateoasBuilder</a>).
Everything works fine out of the box:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\HateoasBuilder</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$hateoas</span> <span class="pl-k">=</span> <span class="pl-c1">HateoasBuilder</span><span class="pl-k">::</span>create()<span class="pl-k">-&gt;</span>build();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$user</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">User</span>(<span class="pl-c1">42</span>, <span class="pl-s"><span class="pl-pds">'</span>Adrien<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Brault<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$json</span> <span class="pl-k">=</span> <span class="pl-smi">$hateoas</span><span class="pl-k">-&gt;</span>serialize(<span class="pl-smi">$user</span>, <span class="pl-s"><span class="pl-pds">'</span>json<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$xml</span>  <span class="pl-k">=</span> <span class="pl-smi">$hateoas</span><span class="pl-k">-&gt;</span>serialize(<span class="pl-smi">$user</span>, <span class="pl-s"><span class="pl-pds">'</span>xml<span class="pl-pds">'</span></span>);</span></pre></div>

<p>The <code>$hateoas</code> object is an instance of <code>JMS\Serializer\SerializerInterface</code>,
coming from the Serializer library. Hateoas does not come with its own
serializer, it hooks into the JMS Serializer.</p>

<p>By default, Hateoas uses the <a href="http://stateless.co/hal_specification.html">Hypertext Application
Language</a> (HAL) for JSON
serialization. This specifies the <em>structure</em> of the response (e.g. that
"links" should live under a <code>_links</code> key):</p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-c1">42</span>,
    <span class="pl-s"><span class="pl-pds">"</span>first_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Adrien<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>last_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Brault<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/api/users/42<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>For XML, <a href="http://tools.ietf.org/search/rfc4287#section-4.2.7">Atom Links</a>
are used by default:</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">user</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>42<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">first_name</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>Adrien<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">first_name</span>&gt;
    &lt;<span class="pl-ent">last_name</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>Brault<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">last_name</span>&gt;
    &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>/api/users/42<span class="pl-pds">"</span></span>/&gt;
&lt;/<span class="pl-ent">user</span>&gt;</pre></div>

<p>It is worth mentioning that these formats are the <strong>default ones</strong>, not the
only available ones. You can use <a href="#serializers--formats">different formats through different
serializers, and even add your owns</a>.</p>

<p>Now that you know how to add <strong>links</strong>, let's see how to add <strong>embedded
resources</strong>.</p>

<h3>
<a id="embedding-resources" class="anchor" href="#embedding-resources" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Embedding Resources</h3>

<p>Sometimes, it's more efficient to embed related resources rather than
link to them, as it prevents clients from having to make extra requests to
fetch those resources.</p>

<p>An <strong>embedded resource</strong> is a named <strong>relation</strong> that contains data, represented
by the <code>embedded</code> parameter.</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">JMS\Serializer\Annotation</span> <span class="pl-k">as</span> <span class="pl-c1">Serializer</span>;</span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration\Annotation</span> <span class="pl-k">as</span> <span class="pl-c1">Hateoas</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * ...</span></span>
<span class="pl-s1"><span class="pl-c"> *</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation(</span></span>
<span class="pl-s1"><span class="pl-c"> *     "manager",</span></span>
<span class="pl-s1"><span class="pl-c"> *     href = "expr('/api/users/' ~ object.getManager().getId())",</span></span>
<span class="pl-s1"><span class="pl-c"> *     embedded = "expr(object.getManager())",</span></span>
<span class="pl-s1"><span class="pl-c"> *     exclusion = @Hateoas\Exclusion(excludeIf = "expr(object.getManager() === null)")</span></span>
<span class="pl-s1"><span class="pl-c"> * )</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">User</span></span>
<span class="pl-s1">{</span>
<span class="pl-s1">    <span class="pl-k">...</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">/** @Serializer\Exclude */</span></span>
<span class="pl-s1">    <span class="pl-k">private</span> <span class="pl-smi">$manager</span>;</span>
<span class="pl-s1">}</span></pre></div>

<p><strong>Note:</strong> You will need to exclude the manager property from the serialization,
otherwise both the serializer and Hateoas will serialize it.
You will also have to exclude the manager relation when the manager is <code>null</code>,
because otherwise an error will occur when creating the <code>href</code> link (calling
<code>getId()</code> on <code>null</code>).</p>

<p><strong>Tip:</strong> If the manager property is an object that already has a <code>_self</code>
link, you can re-use that value for the <code>href</code> instead of repeating it here.
See <a href="#linkhelper">LinkHelper</a>.</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$hateoas</span> <span class="pl-k">=</span> <span class="pl-c1">HateoasBuilder</span><span class="pl-k">::</span>create()<span class="pl-k">-&gt;</span>build();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$user</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">User</span>(<span class="pl-c1">42</span>, <span class="pl-s"><span class="pl-pds">'</span>Adrien<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Brault<span class="pl-pds">'</span></span>, <span class="pl-k">new</span> <span class="pl-c1">User</span>(<span class="pl-c1">23</span>, <span class="pl-s"><span class="pl-pds">'</span>Will<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Durand<span class="pl-pds">'</span></span>));</span>
<span class="pl-s1"><span class="pl-smi">$json</span> <span class="pl-k">=</span> <span class="pl-smi">$hateoas</span><span class="pl-k">-&gt;</span>serialize(<span class="pl-smi">$user</span>, <span class="pl-s"><span class="pl-pds">'</span>json<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$xml</span>  <span class="pl-k">=</span> <span class="pl-smi">$hateoas</span><span class="pl-k">-&gt;</span>serialize(<span class="pl-smi">$user</span>, <span class="pl-s"><span class="pl-pds">'</span>xml<span class="pl-pds">'</span></span>);</span></pre></div>

<p>For <code>json</code>, the HAL representation places these embedded relations inside
an <code>_embedded</code> key:</p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-c1">42</span>,
    <span class="pl-s"><span class="pl-pds">"</span>first_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Adrien<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>last_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Brault<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/api/users/42<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>manager<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/api/users/23<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>_embedded<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>manager<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-c1">23</span>,
            <span class="pl-s"><span class="pl-pds">"</span>first_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Will<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>last_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Durand<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
                <span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {
                    <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/api/users/23<span class="pl-pds">"</span></span>
                }
            }
        }
    }
}</pre></div>

<p>In XML, serializing <code>embedded</code> relations will create new elements:</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">user</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>42<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">first_name</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>Adrien<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">first_name</span>&gt;
    &lt;<span class="pl-ent">last_name</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>Brault<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">last_name</span>&gt;
    &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>/api/users/42<span class="pl-pds">"</span></span>/&gt;
    &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>manager<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>/api/users/23<span class="pl-pds">"</span></span>/&gt;
    &lt;<span class="pl-ent">manager</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>manager<span class="pl-pds">"</span></span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>23<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">first_name</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>Will<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">first_name</span>&gt;
        &lt;<span class="pl-ent">last_name</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>Durand<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">last_name</span>&gt;
        &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>/api/users/23<span class="pl-pds">"</span></span>/&gt;
    &lt;/<span class="pl-ent">manager</span>&gt;
&lt;/<span class="pl-ent">user</span>&gt;</pre></div>

<p>The tag name of an embedded resource is inferred from the
<a href="http://jmsyst.com/libs/serializer/master/reference/annotations#xmlroot"><code>@XmlRoot</code></a>
annotation (<code>xml_root_name</code> in YAML, <code>xml-root-name</code> in XML) coming from the
Serializer configuration.</p>

<h3>
<a id="dealing-with-collections" class="anchor" href="#dealing-with-collections" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dealing With Collections</h3>

<p>The library provides several classes in the <code>Hateoas\Representation\*</code>
namespace to help you with common tasks. These are simple classes configured
with the library's annotations.</p>

<p>The <code>PaginatedRepresentation</code>, <code>OffsetRepresentation</code> and <code>CollectionRepresentation</code> classes are
probably the most interesting ones. These are helpful when your resource is
actually a collection of resources (e.g. <code>/users</code> is a collection of users).
These help you represent the collection and add pagination and limits:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Representation\PaginatedRepresentation</span>;</span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Representation\CollectionRepresentation</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$paginatedCollection</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">PaginatedRepresentation</span>(</span>
<span class="pl-s1">    <span class="pl-k">new</span> <span class="pl-c1">CollectionRepresentation</span>(</span>
<span class="pl-s1">        <span class="pl-c1">array</span>(<span class="pl-smi">$user1</span>, <span class="pl-smi">$user2</span>, <span class="pl-k">...</span>),</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>, <span class="pl-c">// embedded rel</span></span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>  <span class="pl-c">// xml element name</span></span>
<span class="pl-s1">    ),</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>user_list<span class="pl-pds">'</span></span>, <span class="pl-c">// route</span></span>
<span class="pl-s1">    <span class="pl-c1">array</span>(), <span class="pl-c">// route parameters</span></span>
<span class="pl-s1">    <span class="pl-c1">1</span>,       <span class="pl-c">// page number</span></span>
<span class="pl-s1">    <span class="pl-c1">20</span>,      <span class="pl-c">// limit</span></span>
<span class="pl-s1">    <span class="pl-c1">4</span>,       <span class="pl-c">// total pages</span></span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>page<span class="pl-pds">'</span></span>,  <span class="pl-c">// page route parameter name, optional, defaults to 'page'</span></span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>limit<span class="pl-pds">'</span></span>, <span class="pl-c">// limit route parameter name, optional, defaults to 'limit'</span></span>
<span class="pl-s1">    <span class="pl-c1">false</span>,   <span class="pl-c">// generate relative URIs, optional, defaults to `false`</span></span>
<span class="pl-s1">    <span class="pl-c1">75</span>       <span class="pl-c">// total collection size, optional, defaults to `null`</span></span>
<span class="pl-s1">);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$json</span> <span class="pl-k">=</span> <span class="pl-smi">$hateoas</span><span class="pl-k">-&gt;</span>serialize(<span class="pl-smi">$paginatedCollection</span>, <span class="pl-s"><span class="pl-pds">'</span>json<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$xml</span>  <span class="pl-k">=</span> <span class="pl-smi">$hateoas</span><span class="pl-k">-&gt;</span>serialize(<span class="pl-smi">$paginatedCollection</span>, <span class="pl-s"><span class="pl-pds">'</span>xml<span class="pl-pds">'</span></span>);</span></pre></div>

<p>The <code>CollectionRepresentation</code> class allows you to dynamically configure the
collection resources rel, and the xml root element name.</p>

<p>The <code>PaginatedRepresentation</code> is designed to add <code>self</code>, <code>first</code>, and when
possible <code>last</code>, <code>next</code>, and <code>previous</code> links.</p>

<p>The <code>OffsetRepresentation</code> works just like <code>PaginatedRepresentation</code> but is useful
when pagination is expressed by <code>offset</code>, <code>limit</code> and <code>total</code>.</p>

<p>The <code>RouteAwareRepresentation</code> adds a <code>self</code> relation based on a given route.</p>

<p>You can generate <strong>absolute URIs</strong> by setting the <code>absolute</code> parameter to <code>true</code>
in both the <code>PaginatedRepresentation</code> and the <code>RouteAwareRepresentation</code>.</p>

<p>The Hateoas library also provides a <code>PagerfantaFactory</code> to easily build
<code>PaginatedRepresentation</code> from a
<a href="https://github.com/whiteoctober/Pagerfanta">Pagerfanta</a> instance. If you use
the Pagerfanta library, this is an easier way to create the collection
representations:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration\Route</span>;</span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Representation\Factory\PagerfantaFactory</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$pagerfantaFactory</span>   <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">PagerfantaFactory</span>(); <span class="pl-c">// you can pass the page,</span></span>
<span class="pl-s1">                                                <span class="pl-c">// and limit parameters name</span></span>
<span class="pl-s1"><span class="pl-smi">$paginatedCollection</span> <span class="pl-k">=</span> <span class="pl-smi">$pagerfantaFactory</span><span class="pl-k">-&gt;</span>createRepresentation(</span>
<span class="pl-s1">    <span class="pl-smi">$pager</span>,</span>
<span class="pl-s1">    <span class="pl-k">new</span> <span class="pl-c1">Route</span>(<span class="pl-s"><span class="pl-pds">'</span>user_list<span class="pl-pds">'</span></span>, <span class="pl-c1">array</span>())</span>
<span class="pl-s1">);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$json</span> <span class="pl-k">=</span> <span class="pl-smi">$hateoas</span><span class="pl-k">-&gt;</span>serialize(<span class="pl-smi">$paginatedCollection</span>, <span class="pl-s"><span class="pl-pds">'</span>json<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$xml</span>  <span class="pl-k">=</span> <span class="pl-smi">$hateoas</span><span class="pl-k">-&gt;</span>serialize(<span class="pl-smi">$paginatedCollection</span>, <span class="pl-s"><span class="pl-pds">'</span>xml<span class="pl-pds">'</span></span>);</span></pre></div>

<p>You would get the following JSON content:</p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>page<span class="pl-pds">"</span></span>: <span class="pl-c1">1</span>,
    <span class="pl-s"><span class="pl-pds">"</span>limit<span class="pl-pds">"</span></span>: <span class="pl-c1">10</span>,
    <span class="pl-s"><span class="pl-pds">"</span>pages<span class="pl-pds">"</span></span>: <span class="pl-c1">1</span>,
    <span class="pl-s"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/api/users?page=1&amp;limit=10<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>first<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/api/users?page=1&amp;limit=10<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>last<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/api/users?page=1&amp;limit=10<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>_embedded<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>items<span class="pl-pds">"</span></span>: [
            { <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-c1">123</span> },
            { <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-c1">456</span> }
        ]
    }
}</pre></div>

<p>And the following XML content:</p>

<div class="highlight highlight-text-xml"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
&lt;<span class="pl-ent">collection</span> <span class="pl-e">page</span>=<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span> <span class="pl-e">limit</span>=<span class="pl-s"><span class="pl-pds">"</span>10<span class="pl-pds">"</span></span> <span class="pl-e">pages</span>=<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">user</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>123<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">user</span>&gt;
    &lt;<span class="pl-ent">user</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>456<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">user</span>&gt;
    &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>/api/users?page=1<span class="pl-c1">&amp;amp;</span>limit=10<span class="pl-pds">"</span></span> /&gt;
    &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>first<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>/api/users?page=1<span class="pl-c1">&amp;amp;</span>limit=10<span class="pl-pds">"</span></span> /&gt;
    &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>last<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>/api/users?page=1<span class="pl-c1">&amp;amp;</span>limit=10<span class="pl-pds">"</span></span> /&gt;
&lt;/<span class="pl-ent">collection</span>&gt;</pre></div>

<p>If you want to customize the inlined <code>CollectionRepresentation</code>, pass one as
third argument of the <code>createRepresentation()</code> method:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Representation\Factory\PagerfantaFactory</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$pagerfantaFactory</span>   <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">PagerfantaFactory</span>(); <span class="pl-c">// you can pass the page and limit parameters name</span></span>
<span class="pl-s1"><span class="pl-smi">$paginatedCollection</span> <span class="pl-k">=</span> <span class="pl-smi">$pagerfantaFactory</span><span class="pl-k">-&gt;</span>createRepresentation(</span>
<span class="pl-s1">    <span class="pl-smi">$pager</span>,</span>
<span class="pl-s1">    <span class="pl-k">new</span> <span class="pl-c1">Route</span>(<span class="pl-s"><span class="pl-pds">'</span>user_list<span class="pl-pds">'</span></span>, <span class="pl-c1">array</span>()),</span>
<span class="pl-s1">    <span class="pl-k">new</span> <span class="pl-c1">CollectionRepresentation</span>(</span>
<span class="pl-s1">        <span class="pl-smi">$pager</span><span class="pl-k">-&gt;</span>getCurrentPageResults(),</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>users<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">        <span class="pl-k">new</span> <span class="pl-c1">Exclusion</span>(<span class="pl-k">...</span>)</span>
<span class="pl-s1">    )</span>
<span class="pl-s1">);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$json</span> <span class="pl-k">=</span> <span class="pl-smi">$hateoas</span><span class="pl-k">-&gt;</span>serialize(<span class="pl-smi">$paginatedCollection</span>, <span class="pl-s"><span class="pl-pds">'</span>json<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$xml</span>  <span class="pl-k">=</span> <span class="pl-smi">$hateoas</span><span class="pl-k">-&gt;</span>serialize(<span class="pl-smi">$paginatedCollection</span>, <span class="pl-s"><span class="pl-pds">'</span>xml<span class="pl-pds">'</span></span>);</span></pre></div>

<p>If you want to change the xml root name of the collection, create a new
class with the xml root configured and use the inline mechanism:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">JMS\Serializer\Annotation</span> <span class="pl-k">as</span> <span class="pl-c1">Serializer</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * @Serializer\XmlRoot("users")</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">UsersRepresentation</span></span>
<span class="pl-s1">{</span>
<span class="pl-s1">    <span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c">     * @Serializer\Inline</span></span>
<span class="pl-s1"><span class="pl-c">     */</span></span>
<span class="pl-s1">    <span class="pl-k">private</span> <span class="pl-smi">$inline</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-c1">__construct</span>(<span class="pl-smi">$inline</span>)</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-smi">$this</span><span class="pl-k">-&gt;</span><span class="pl-smi">inline</span> <span class="pl-k">=</span> <span class="pl-smi">$inline</span>;</span>
<span class="pl-s1">    }</span>
<span class="pl-s1">}</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$paginatedCollection</span> <span class="pl-k">=</span> <span class="pl-k">...</span>;</span>
<span class="pl-s1"><span class="pl-smi">$paginatedCollection</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">UsersRepresentation</span>(<span class="pl-smi">$paginatedCollection</span>);</span></pre></div>

<h3>
<a id="representations" class="anchor" href="#representations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Representations</h3>

<p>As mentionned in the previous section, <strong>representations</strong> are classes configured
with the library's annotations in order to help you with common tasks. The
<strong>collection representations</strong> are described in <a href="#dealing-with-collections">Dealing With
Collection</a>.</p>

<h4>
<a id="vnderrorrepresentation" class="anchor" href="#vnderrorrepresentation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>VndErrorRepresentation</h4>

<p>The <code>VndErrorRepresentation</code> allows you to describe an error response following
the <a href="https://github.com/blongden/vnd.error"><code>vnd.error</code> specification</a>.</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$error</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">VndErrorRepresentation</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>Validation failed<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">    <span class="pl-c1">42</span>,</span>
<span class="pl-s1">    <span class="pl-k">new</span> <span class="pl-c1">Relation</span>(<span class="pl-s"><span class="pl-pds">'</span>help<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>http://.../<span class="pl-pds">'</span></span>, <span class="pl-c1">null</span>, <span class="pl-c1">array</span>(<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>Error Information<span class="pl-pds">'</span></span>)),</span>
<span class="pl-s1">    <span class="pl-k">new</span> <span class="pl-c1">Relation</span>(<span class="pl-s"><span class="pl-pds">'</span>describes<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>http://.../<span class="pl-pds">'</span></span>, <span class="pl-c1">null</span>, <span class="pl-c1">array</span>(<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>Error Description<span class="pl-pds">'</span></span>))</span>
<span class="pl-s1">);</span></pre></div>

<p>Serializing such a representation in XML and JSON would give you the following
outputs:</p>

<div class="highlight highlight-text-xml"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
    &lt;<span class="pl-ent">resource</span> <span class="pl-e">logref</span>=<span class="pl-s"><span class="pl-pds">"</span>42<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">message</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>Validation failed<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">message</span>&gt;
    &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>help<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>http://.../<span class="pl-pds">"</span></span> <span class="pl-e">title</span>=<span class="pl-s"><span class="pl-pds">"</span>Error Information<span class="pl-pds">"</span></span>/&gt;
    &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>describes<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>http://.../<span class="pl-pds">"</span></span> <span class="pl-e">title</span>=<span class="pl-s"><span class="pl-pds">"</span>Error Description<span class="pl-pds">"</span></span>/&gt;
&lt;/<span class="pl-ent">resource</span>&gt;</pre></div>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>message<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Validation failed<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>logref<span class="pl-pds">"</span></span>: <span class="pl-c1">42</span>,
    <span class="pl-s"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>help<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://.../<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Error Information<span class="pl-pds">"</span></span>
        },
        <span class="pl-s"><span class="pl-pds">"</span>describes<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://.../<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Error Description<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p><strong>Hint:</strong> it is recommended to create your own error classes that extend the
<code>VndErrorRepresentation</code> class.</p>

<h3>
<a id="the-expression-language" class="anchor" href="#the-expression-language" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Expression Language</h3>

<p>Hateoas relies on the powerful Symfony
<a href="http://symfony.com/doc/current/components/expression_language/introduction.html">ExpressionLanguage</a>
component to retrieve values such as links, ids or objects to embed.</p>

<p>Each time you fill in a value (e.g. a Relation <code>href</code> in annotations or YAML),
you can either pass a <strong>hardcoded value</strong> or an <strong>expression</strong>.
In order to use the Expression Language, you have to use the <code>expr()</code> notation:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation("self", href = "expr('/api/users/' ~ object.getId())")</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span></pre></div>

<p>You can learn more about the Expression Syntax by reading the official
documentation: <a href="http://symfony.com/doc/current/components/expression_language/syntax.html">The Expression
Syntax</a>.</p>

<h4>
<a id="context" class="anchor" href="#context" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Context</h4>

<p>Natively, a special variable named <code>object</code> is available in each expression, and
represents the current object:</p>

<pre><code>expr(object.getId())
</code></pre>

<p>We call such a variable a <strong>context variable</strong>.</p>

<p>You can add your own context variables to the Expression Language context by
adding them to the <code>ExpressionEvaluator</code>.</p>

<h5>
<a id="adding-your-own-context-variables" class="anchor" href="#adding-your-own-context-variables" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Adding Your Own Context Variables</h5>

<p>Using the <code>HateoasBuilder</code>, call the <code>setExpressionContextVariable()</code> method to add
new context variables:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\HateoasBuilder</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$hateoas</span> <span class="pl-k">=</span> <span class="pl-c1">HateoasBuilder</span><span class="pl-k">::</span>create()</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>setExpressionContextVariable(<span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>, <span class="pl-k">new</span> <span class="pl-c1">Foo</span>())</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>build();</span></pre></div>

<p>The <code>foo</code> variable is now available:</p>

<pre><code>expr(foo !== null)
</code></pre>

<h5>
<a id="expression-functions" class="anchor" href="#expression-functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Expression Functions</h5>

<p><strong>Expression Functions</strong> are custom functions used to extend the <a href="#the-expression-language">Expression
Language</a> as explained in the <a href="http://symfony.com/doc/current/components/expression_language/extending.html">Extending the
ExpressionLanguage</a>,
part of the Symfony documentation.</p>

<p>Hateoas provides core expression functions such as the <code>LinkExpressionFunction</code>
described in <a href="#the-link-function">LinkHelper - The <code>link</code> Function</a>, but you can
also write your own function.
The <code>ExpressionFunctionInterface</code> is designed to represent an expression
function. Adding a new expression function is a matter of implementing this
interface and registering by calling the <code>registerExpressionFunction()</code> method
on the <a href="#the-hateoasbuilder">HateoasBuilder</a>.</p>

<h3>
<a id="url-generators" class="anchor" href="#url-generators" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>URL Generators</h3>

<p>Since you can use the <a href="#the-expression-language">Expression Language</a> to define
the relations links (<code>href</code> key), you can do a lot by default. However if you
are using a framework, chances are that you will want to use routes to build
links.</p>

<p>You will first need to configure an <code>UrlGenerator</code> on the builder. You can
either implement the <code>Hateoas\UrlGenerator\UrlGeneratorInterface</code>, or use the
<code>Hateoas\UrlGenerator\CallableUrlGenerator</code>:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\UrlGenerator\CallableUrlGenerator</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$hateoas</span> <span class="pl-k">=</span> <span class="pl-c1">HateoasBuilder</span><span class="pl-k">::</span>create()</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>setUrlGenerator(</span>
<span class="pl-s1">        <span class="pl-c1">null</span>, <span class="pl-c">// By default all links uses the generator configured with the null name</span></span>
<span class="pl-s1">        <span class="pl-k">new</span> <span class="pl-c1">CallableUrlGenerator</span>(<span class="pl-k">function</span> (<span class="pl-smi">$route</span>, <span class="pl-k">array</span> <span class="pl-smi">$parameters</span>, <span class="pl-smi">$absolute</span>) <span class="pl-k">use</span> (<span class="pl-smi">$myFramework</span>) {</span>
<span class="pl-s1">            <span class="pl-k">return</span> <span class="pl-smi">$myFramework</span><span class="pl-k">-&gt;</span>generateTheUrl(<span class="pl-smi">$route</span>, <span class="pl-smi">$parameters</span>, <span class="pl-smi">$absolute</span>);</span>
<span class="pl-s1">        })</span>
<span class="pl-s1">    )</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>build()</span>
<span class="pl-s1">;</span></pre></div>

<p>You will then be able to use the <a href="#route">@Route</a> annotation:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration\Annotation</span> <span class="pl-k">as</span> <span class="pl-c1">Hateoas</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation(</span></span>
<span class="pl-s1"><span class="pl-c"> *      "self",</span></span>
<span class="pl-s1"><span class="pl-c"> *      href = @Hateoas\Route(</span></span>
<span class="pl-s1"><span class="pl-c"> *          "user_get",</span></span>
<span class="pl-s1"><span class="pl-c"> *          parameters = {</span></span>
<span class="pl-s1"><span class="pl-c"> *              "id" = "expr(object.getId())"</span></span>
<span class="pl-s1"><span class="pl-c"> *          }</span></span>
<span class="pl-s1"><span class="pl-c"> *      )</span></span>
<span class="pl-s1"><span class="pl-c"> * )</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">User</span></span></pre></div>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-c1">42</span>,
    <span class="pl-s"><span class="pl-pds">"</span>first_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Adrien<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>last_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Brault<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/api/users/42<span class="pl-pds">"</span></span>
        }
    }
}</pre></div>

<p>Note that the library comes with a <code>SymfonyUrlGenerator</code>. For example, to use it
in Silex:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\UrlGenerator\SymfonyUrlGenerator</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$hateoas</span> <span class="pl-k">=</span> <span class="pl-c1">HateoasBuilder</span><span class="pl-k">::</span>create()</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>setUrlGenerator(<span class="pl-c1">null</span>, <span class="pl-k">new</span> <span class="pl-c1">SymfonyUrlGenerator</span>(<span class="pl-smi">$app</span>[<span class="pl-s"><span class="pl-pds">'</span>url_generator<span class="pl-pds">'</span></span>]))</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>build()</span>
<span class="pl-s1">;</span></pre></div>

<h3>
<a id="helpers" class="anchor" href="#helpers" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Helpers</h3>

<p>Hateoas provides a set of helpers to ease the process of building APIs.</p>

<h4>
<a id="linkhelper" class="anchor" href="#linkhelper" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>LinkHelper</h4>

<p>The <code>LinkHelper</code> class provides a <code>getLinkHref($object, $rel, $absolute = false)</code>
method that allows you to get the <em>href</em> value of any object, for any given
relation name. It is able to generate a URI (either absolute or relative) from
any <strong>link</strong> relation:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$user</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">User</span>(<span class="pl-c1">123</span>, <span class="pl-s"><span class="pl-pds">'</span>William<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Durand<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$linkHelper</span><span class="pl-k">-&gt;</span>getLinkHref(<span class="pl-smi">$user</span>, <span class="pl-s"><span class="pl-pds">'</span>self<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-c">// /api/users/123</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$linkHelper</span><span class="pl-k">-&gt;</span>getLinkHref(<span class="pl-smi">$user</span>, <span class="pl-s"><span class="pl-pds">'</span>self<span class="pl-pds">'</span></span>, <span class="pl-c1">true</span>);</span>
<span class="pl-s1"><span class="pl-c">// http://example.com/api/users/123</span></span></pre></div>

<h5>
<a id="the-link-function" class="anchor" href="#the-link-function" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The <code>link</code> Function</h5>

<p>The feature above is also available in your expressions (cf. <a href="#the-expression-language">The Expression
Language</a>) through the <code>link(object, rel, absolute)</code>
<strong>function</strong>:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation(</span></span>
<span class="pl-s1"><span class="pl-c"> *     "self",</span></span>
<span class="pl-s1"><span class="pl-c"> *     href = @Hateoas\Route("post_get", parameters = {"id" = "expr(object.getId())"})</span></span>
<span class="pl-s1"><span class="pl-c"> * )</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">Post</span> {}</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation(</span></span>
<span class="pl-s1"><span class="pl-c"> *     "self",</span></span>
<span class="pl-s1"><span class="pl-c"> *     href = @Hateoas\Route("user_get", parameters = {"id" = "expr(object.getId())"})</span></span>
<span class="pl-s1"><span class="pl-c"> * )</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation(</span></span>
<span class="pl-s1"><span class="pl-c"> *     "post",</span></span>
<span class="pl-s1"><span class="pl-c"> *     href = "expr(link(object.getPost(), 'self', true))"</span></span>
<span class="pl-s1"><span class="pl-c"> * )</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation(</span></span>
<span class="pl-s1"><span class="pl-c"> *     "relative",</span></span>
<span class="pl-s1"><span class="pl-c"> *     href = "expr(link(object.getRelativePost(), 'self'))"</span></span>
<span class="pl-s1"><span class="pl-c"> * )</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">User</span></span>
<span class="pl-s1">{</span>
<span class="pl-s1">    <span class="pl-k">...</span></span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">getPost</span>()</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-c1">Post</span>(<span class="pl-c1">456</span>);</span>
<span class="pl-s1">    }</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">getRelativePost</span>()</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-c1">Post</span>(<span class="pl-c1">789</span>);</span>
<span class="pl-s1">    }</span>
<span class="pl-s1">}</span></pre></div>

<p>Pay attention to the <code>href</code> expressions for the <code>post</code> and <code>relative</code> relations,
as well as their corresponding values in the following JSON content:</p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>user<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>: <span class="pl-c1">123</span>,
        <span class="pl-s"><span class="pl-pds">"</span>first_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>William<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>last_name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Durand<span class="pl-pds">"</span></span>,
        <span class="pl-s"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: { <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://example.com/api/users/123<span class="pl-pds">"</span></span> },
            <span class="pl-s"><span class="pl-pds">"</span>post<span class="pl-pds">"</span></span>: { <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>http://example.com/api/posts/456<span class="pl-pds">"</span></span> },
            <span class="pl-s"><span class="pl-pds">"</span>relative<span class="pl-pds">"</span></span>: { <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/api/posts/789<span class="pl-pds">"</span></span> }
        }
    }
}</pre></div>

<p>It is worth mentioning that you can <strong>force</strong> whether you want an absolute or
relative URI by using the third argument in both the <code>getLinkHref()</code> method and
the <code>link</code> function.</p>

<p><strong>Important:</strong> by default, all URIs will be <strong>relative</strong>, even those which are
defined as <strong>absolute</strong> in their configuration.</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$linkHelper</span><span class="pl-k">-&gt;</span>getLinkHref(<span class="pl-smi">$user</span>, <span class="pl-s"><span class="pl-pds">'</span>post<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-c">// /api/posts/456</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$linkHelper</span><span class="pl-k">-&gt;</span>getLinkHref(<span class="pl-smi">$user</span>, <span class="pl-s"><span class="pl-pds">'</span>post<span class="pl-pds">'</span></span>, <span class="pl-c1">true</span>);</span>
<span class="pl-s1"><span class="pl-c">// http://example.com/api/posts/456</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$linkHelper</span><span class="pl-k">-&gt;</span>getLinkHref(<span class="pl-smi">$user</span>, <span class="pl-s"><span class="pl-pds">'</span>relative<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-c">// /api/posts/789</span></span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$linkHelper</span><span class="pl-k">-&gt;</span>getLinkHref(<span class="pl-smi">$user</span>, <span class="pl-s"><span class="pl-pds">'</span>relative<span class="pl-pds">'</span></span>, <span class="pl-c1">true</span>);</span>
<span class="pl-s1"><span class="pl-c">// http://example.com/api/posts/789</span></span></pre></div>

<h3>
<a id="twig-extensions" class="anchor" href="#twig-extensions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Twig Extensions</h3>

<p>Hateoas also provides a set of <a href="http://twig.sensiolabs.org">Twig</a> extensions.</p>

<h4>
<a id="linkextension" class="anchor" href="#linkextension" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>LinkExtension</h4>

<p>The <code>LinkExtension</code> allows you to use the <a href="#linkhelper">LinkHelper</a> into your
Twig templates, so that you can generate links in your HTML templates for
instance.</p>

<p>This extension exposes the <code>getLinkHref()</code> helper's method through the
<code>link_href</code> Twig function:</p>

<div class="highlight highlight-text-html-django"><pre>{{ link_href(user, 'self') }}
<span class="pl-c">{# will generate: /users/123 #}</span>

{{ link_href(will, 'self', false) }}
<span class="pl-c">{# will generate: /users/123 #}</span>

{{ link_href(will, 'self', true) }}
<span class="pl-c">{# will generate: http://example.com/users/123 #}</span></pre></div>

<h3>
<a id="serializers--formats" class="anchor" href="#serializers--formats" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Serializers &amp; Formats</h3>

<p>Hateoas provides a set of <strong>serializers</strong>. Each <strong>serializer</strong> allows you to
generate either XML or JSON content following a specific <strong>format</strong>, such as
<a href="http://stateless.co/hal_specification.html">HAL</a>, or <a href="http://tools.ietf.org/search/rfc4287#section-4.2.7">Atom
Links</a> for instance.</p>

<h4>
<a id="the-jsonhalserializer" class="anchor" href="#the-jsonhalserializer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The JsonHalSerializer</h4>

<p>The <code>JsonHalSerializer</code> allows you to generate HAL compliant relations in JSON.
It is the default JSON serializer in Hateoas.</p>

<p>HAL provides its linking capability with a convention which says that a resource
object has a reserved property called <code>_links</code>. This property is an object that
contains links. These links are key'ed by their link relation.</p>

<p>HAL also describes another convention which says that a resource may have
another reserved property named <code>_embedded</code>. This property is similar to <code>_links</code>
in that embedded resources are key'ed by relation name. The main difference is
that rather than being links, the values are resource objects.</p>

<p><img src="http://stateless.co/info-model.png" alt=""></p>

<div class="highlight highlight-source-json"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>message<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Hello, World!<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>_links<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>: {
            <span class="pl-s"><span class="pl-pds">"</span>href<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>/notes/0<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>_embedded<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>associated_events<span class="pl-pds">"</span></span>: [
            {
                <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>SymfonyCon<span class="pl-pds">"</span></span>,
                <span class="pl-s"><span class="pl-pds">"</span>date<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>2013-12-12T00:00:00+0100<span class="pl-pds">"</span></span>
            }
        ]
    }
}</pre></div>

<h4>
<a id="the-xmlserializer" class="anchor" href="#the-xmlserializer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The XmlSerializer</h4>

<p>The <code>XmlSerializer</code> allows you to generate <a href="http://tools.ietf.org/search/rfc4287#section-4.2.7">Atom
Links</a> into your XML
documents. It is the default XML serializer.</p>

<div class="highlight highlight-text-xml"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
&lt;<span class="pl-ent">note</span>&gt;
    &lt;<span class="pl-ent">message</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>Hello, World!<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">message</span>&gt;
    &lt;<span class="pl-ent">link</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>/notes/0<span class="pl-pds">"</span></span> /&gt;
    &lt;<span class="pl-ent">events</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>associated_events<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">event</span>&gt;
            &lt;<span class="pl-ent">name</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>SymfonyCon<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">name</span>&gt;
            &lt;<span class="pl-ent">date</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>2013-12-12T00:00:00+0100<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">date</span>&gt;
        &lt;/<span class="pl-ent">event</span>&gt;
    &lt;/<span class="pl-ent">events</span>&gt;
&lt;/<span class="pl-ent">note</span>&gt;</pre></div>

<h4>
<a id="the-xmlhalserializer" class="anchor" href="#the-xmlhalserializer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The XmlHalSerializer</h4>

<p>The <code>XmlHalSerializer</code> allows you to generate HAL compliant relations in XML.</p>

<p>HAL in XML is similar to <a href="#the-jsonhalserializer">HAL in JSON</a> in the sense that
it describes <code>link</code> tags and <code>resource</code> tags.</p>

<p><strong>Note:</strong> the <code>self</code> relation will actually become an attribute of the main
resource instead of being a <code>link</code> tag. Other links will be generated as <code>link</code>
tags.</p>

<div class="highlight highlight-text-xml"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
&lt;<span class="pl-ent">note</span> <span class="pl-e">href</span>=<span class="pl-s"><span class="pl-pds">"</span>/notes/0<span class="pl-pds">"</span></span>&gt;
    &lt;<span class="pl-ent">message</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>Hello, World!<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">message</span>&gt;

    &lt;<span class="pl-ent">resource</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>associated_events<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">name</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>SymfonyCon<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">name</span>&gt;
        &lt;<span class="pl-ent">date</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span>2013-12-12T00:00:00+0100<span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">date</span>&gt;
    &lt;/<span class="pl-ent">resource</span>&gt;
&lt;/<span class="pl-ent">note</span>&gt;</pre></div>

<h4>
<a id="adding-new-serializers" class="anchor" href="#adding-new-serializers" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Adding New Serializers</h4>

<p>For JSON related formats, you must implement the <code>JsonSerializerInterface</code>
interface, and for XML related formats, you must implement the
<code>XmlSerializerInterface</code>. Both interfaces describe two methods to serialize
<strong>links</strong> and <strong>embedded</strong> relations.</p>

<h3>
<a id="the-hateoasbuilder" class="anchor" href="#the-hateoasbuilder" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The HateoasBuilder</h3>

<p>The <code>HateoasBuilder</code> class is used to easily configure Hateoas thanks to a
powerful and fluent API.</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\HateoasBuilder</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$hateoas</span> <span class="pl-k">=</span> <span class="pl-c1">HateoasBuilder</span><span class="pl-k">::</span>create()</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>setCacheDir(<span class="pl-s"><span class="pl-pds">'</span>/path/to/cache/dir<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>setDebug(<span class="pl-smi">$trueOrFalse</span>)</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>setDefaultXmlSerializer()</span>
<span class="pl-s1">    <span class="pl-k">...</span></span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>build();</span></pre></div>

<p>All the methods below return the current builder, so that you can chain them.</p>

<h4>
<a id="xml-serializer" class="anchor" href="#xml-serializer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>XML Serializer</h4>

<ul>
<li>
<code>setXmlSerializer(XmlSerializerInterface $xmlSerializer)</code>: sets the XML
serializer to use. Default is: <code>XmlSerializer</code>;</li>
<li>
<code>setDefaultXmlSerializer()</code>: sets the default XML serializer
(<code>XmlSerializer</code>).</li>
</ul>

<h4>
<a id="json-serializer" class="anchor" href="#json-serializer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>JSON Serializer</h4>

<ul>
<li>
<code>setJsonSerializer(JsonSerializerInterface $jsonSerializer)</code>: sets the JSON
serializer to use. Default is: <code>JsonHalSerializer</code>;</li>
<li>
<code>setDefaultJsonSerializer()</code>: sets the default JSON serializer
(<code>JsonHalSerializer</code>).</li>
</ul>

<h4>
<a id="url-generator" class="anchor" href="#url-generator" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>URL Generator</h4>

<ul>
<li>
<code>setUrlGenerator($name = null, UrlGeneratorInterface $urlGenerator)</code>: adds a
new named URL generator. If <code>$name</code> is <code>null</code>, the URL generator will be the
default one.</li>
</ul>

<h4>
<a id="expression-evaluatorexpression-language" class="anchor" href="#expression-evaluatorexpression-language" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Expression Evaluator/Expression Language</h4>

<ul>
<li>
<code>setExpressionContextVariable($name, $value)</code>: adds a new expression context
variable;</li>
<li>
<code>setExpressionLanguage(ExpressionLanguage $expressionLanguage)</code>;</li>
<li>
<code>registerExpressionFunction(ExpressionFunctionInterface
$expressionFunction)</code>: adds a new expression function.</li>
</ul>

<h4>
<a id="relation-provider" class="anchor" href="#relation-provider" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Relation Provider</h4>

<ul>
<li>
<code>addRelationProviderResolver(RelationProviderResolverInterface $resolver)</code>:
adds a new relation provider resolver.</li>
</ul>

<h4>
<a id="jms-serializer-specific" class="anchor" href="#jms-serializer-specific" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>(JMS) Serializer Specific</h4>

<ul>
<li>
<code>includeInterfaceMetadata($include)</code>: whether to include the metadata from the
interfaces;</li>
<li>
<code>setMetadataDirs(array $namespacePrefixToDirMap)</code>: sets a map of namespace
prefixes to directories. This method overrides any previously defined
directories;</li>
<li>
<code>addMetadataDir($dir, $namespacePrefix = '')</code>: adds a directory where the
serializer will look for class metadata;</li>
<li>
<code>addMetadataDirs(array $namespacePrefixToDirMap)</code>: adds a map of namespace
prefixes to directories;</li>
<li>
<code>replaceMetadataDir($dir, $namespacePrefix = '')</code>: similar to
<code>addMetadataDir()</code>, but overrides an existing entry.</li>
</ul>

<p>Please read the official <a href="http://jmsyst.com/libs/serializer">Serializer
documentation</a> for more details.</p>

<h4>
<a id="others" class="anchor" href="#others" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Others</h4>

<ul>
<li>
<code>setDebug($debug)</code>: enables or disables the debug mode;</li>
<li>
<code>setCacheDir($dir)</code>: sets the cache directory.</li>
</ul>

<h3>
<a id="configuring-a-cache-directory" class="anchor" href="#configuring-a-cache-directory" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuring a Cache Directory</h3>

<p>Both the serializer and the Hateoas libraries collect metadata about your
objects from various sources such as YML, XML, or annotations. In order to make
this process as efficient as possible, it is recommended that you allow the
Hateoas library to cache this information. To do that, configure a cache
directory:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$builder</span> <span class="pl-k">=</span> <span class="pl-c1">\Hateoas\</span><span class="pl-c1">HateoasBuilder</span><span class="pl-k">::</span>create();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$hateoas</span> <span class="pl-k">=</span> <span class="pl-smi">$builder</span></span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>setCacheDir(<span class="pl-smi">$someWritableDir</span>)</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>build();</span></pre></div>

<h3>
<a id="configuring-metadata-locations" class="anchor" href="#configuring-metadata-locations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Configuring Metadata Locations</h3>

<p>Hateoas supports several metadata sources. By default, it uses Doctrine
annotations, but you may also store metadata in XML, or YAML files. For the
latter, it is necessary to configure a metadata directory where those files are
located:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$hateoas</span> <span class="pl-k">=</span> <span class="pl-c1">\Hateoas\</span><span class="pl-c1">HateoasBuilder</span><span class="pl-k">::</span>create()</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>addMetadataDir(<span class="pl-smi">$someDir</span>)</span>
<span class="pl-s1">    <span class="pl-k">-&gt;</span>build();</span></pre></div>

<p>Hateoas would expect the metadata files to be named like the fully qualified
class names where all <code>\</code> are replaced with <code>.</code>. If you class would be named
<code>Vendor\Package\Foo</code> the metadata file would need to be located at
<code>$someDir/Vendor.Package.Foo.(xml|yml)</code>.</p>

<h3>
<a id="extending-the-library" class="anchor" href="#extending-the-library" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Extending The Library</h3>

<p>Hateoas allows frameworks to dynamically add relations to classes by providing
an extension point at configuration level. This feature can be useful for those
who want to to create a new layer on top of Hateoas, or to add "global"
relations rather than copying the same configuration on each class.</p>

<p>In order to leverage this mechanism, the <code>ConfigurationExtensionInterface</code>
interface has to be implemented:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration\Metadata\ConfigurationExtensionInterface</span>;</span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration\Metadata\ClassMetadataInterface</span>;</span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration\Relation</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">AcmeFooConfigurationExtension</span> <span class="pl-k">implements</span> <span class="pl-e">ConfigurationExtensionInterface</span></span>
<span class="pl-s1">{</span>
<span class="pl-s1">    <span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c">     * {@inheritDoc}</span></span>
<span class="pl-s1"><span class="pl-c">     */</span></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">decorate</span>(<span class="pl-c1">ClassMetadataInterface</span> <span class="pl-smi">$classMetadata</span>)</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-k">if</span> (<span class="pl-c1">0</span> <span class="pl-k">===</span> <span class="pl-c1">strpos</span>(<span class="pl-s"><span class="pl-pds">'</span>Acme\Foo\Model<span class="pl-pds">'</span></span>, <span class="pl-smi">$classMetadata</span><span class="pl-k">-&gt;</span>getName())) {</span>
<span class="pl-s1">            <span class="pl-c">// Add a "root" relation to all classes in the `Acme\Foo\Model` namespace</span></span>
<span class="pl-s1">            <span class="pl-smi">$classMetadata</span><span class="pl-k">-&gt;</span>addRelation(</span>
<span class="pl-s1">                <span class="pl-k">new</span> <span class="pl-c1">Relation</span>(</span>
<span class="pl-s1">                    <span class="pl-s"><span class="pl-pds">'</span>root<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                    <span class="pl-s"><span class="pl-pds">'</span>/<span class="pl-pds">'</span></span></span>
<span class="pl-s1">                )</span>
<span class="pl-s1">            );</span>
<span class="pl-s1">        }</span>
<span class="pl-s1">    }</span>
<span class="pl-s1">}</span></pre></div>

<p>You can access the existing relations loaded from Annotations, XML, or YAML with
<code>$classMetadata-&gt;getRelations()</code>.</p>

<p>If the <code>$classMetadata</code> has relations, or if you add relations to it, its
relations will be cached. So if you read configuration files (Annotations, XML,
or YAML), make sure to reference them on the class metadata:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$classMetadata</span><span class="pl-k">-&gt;</span><span class="pl-smi">fileResources</span>[] <span class="pl-k">=</span> <span class="pl-smi">$file</span>;</span></pre></div>

<h2>
<a id="reference" class="anchor" href="#reference" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Reference</h2>

<h3>
<a id="xml" class="anchor" href="#xml" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>XML</h3>

<div class="highlight highlight-text-xml"><pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">"</span>UTF-8<span class="pl-pds">"</span></span>?&gt;
&lt;<span class="pl-ent">serializer</span>&gt;
&lt;<span class="pl-ent">class</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>Acme\Demo\Representation\User<span class="pl-pds">"</span></span> <span class="pl-e">h</span><span class="pl-e">:</span><span class="pl-e">providers</span>=<span class="pl-s"><span class="pl-pds">"</span>Class::getRelations, getRelations<span class="pl-pds">"</span></span> <span class="pl-e">xmlns</span><span class="pl-e">:</span><span class="pl-e">h</span>=<span class="pl-s"><span class="pl-pds">"</span>https://github.com/willdurand/Hateoas<span class="pl-pds">"</span></span>&gt;
        &lt;<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">relation</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>self<span class="pl-pds">"</span></span>&gt;
            &lt;<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">href</span> <span class="pl-e">uri</span>=<span class="pl-s"><span class="pl-pds">"</span>http://acme.com/foo/1<span class="pl-pds">"</span></span> /&gt;
        &lt;/<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">relation</span>&gt;
        &lt;<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">relation</span> <span class="pl-e">rel</span>=<span class="pl-s"><span class="pl-pds">"</span>expr(object.getFriendsDynamicRel())<span class="pl-pds">"</span></span>&gt;
            &lt;<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">href</span> <span class="pl-e">route</span>=<span class="pl-s"><span class="pl-pds">"</span>user_friends<span class="pl-pds">"</span></span> <span class="pl-e">generator</span>=<span class="pl-s"><span class="pl-pds">"</span>my_custom_generator<span class="pl-pds">"</span></span>&gt;
                &lt;<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">parameter</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">"</span>expr(object.getId())<span class="pl-pds">"</span></span> /&gt;
                &lt;<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">parameter</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">"</span>page<span class="pl-pds">"</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span> /&gt;
            &lt;/<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">ref</span>&gt;
            &lt;<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">embedded</span> <span class="pl-e">xml-element-name</span>=<span class="pl-s"><span class="pl-pds">"</span>users<span class="pl-pds">"</span></span>&gt;
                &lt;<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">content</span>&gt;expr(object.getFriends())&lt;/<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">content</span>&gt;
                &lt;<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">exclusion</span> ... /&gt;
            &lt;/<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">embedded</span>&gt;
            &lt;<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">exclusion</span> <span class="pl-e">groups</span>=<span class="pl-s"><span class="pl-pds">"</span>Default, user_full<span class="pl-pds">"</span></span> <span class="pl-e">since-version</span>=<span class="pl-s"><span class="pl-pds">"</span>1.0<span class="pl-pds">"</span></span> <span class="pl-e">until-version</span>=<span class="pl-s"><span class="pl-pds">"</span>2.2<span class="pl-pds">"</span></span> <span class="pl-e">exclude-if</span>=<span class="pl-s"><span class="pl-pds">"</span>expr(object.getFriends() === null)<span class="pl-pds">"</span></span> /&gt;
        &lt;/<span class="pl-ent">h</span><span class="pl-ent">:</span><span class="pl-ent">relation</span>&gt;
    &lt;/<span class="pl-ent">class</span>&gt;
&lt;/<span class="pl-ent">serializer</span>&gt;</pre></div>

<p>See the
<a href="https://github.com/willdurand/Hateoas/blob/master/hateoas.xsd"><code>hateoas.xsd</code></a>
file for more details.</p>

<h3>
<a id="yaml" class="anchor" href="#yaml" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>YAML</h3>

<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">Acme\Demo\Representation\User:</span>
    <span class="pl-ent">relations:</span>
        -
            <span class="pl-ent">rel:</span> <span class="pl-s">self</span>
            <span class="pl-ent">href:</span> <span class="pl-s">http://acme.com/foo/1</span>
        -
            <span class="pl-ent">rel:</span> <span class="pl-s">expr(object.getFriendsDynamicRel())</span>
            <span class="pl-ent">href:</span>
                <span class="pl-ent">route:</span> <span class="pl-s">user_friends</span>
                <span class="pl-ent">parameters:</span>
                    <span class="pl-ent">id:</span> <span class="pl-s">expr(object.getId())</span>
                    <span class="pl-ent">page:</span> <span class="pl-c1">1</span>
                <span class="pl-ent">generator:</span> <span class="pl-s">my_custom_generator</span>
                <span class="pl-ent">absolute:</span> <span class="pl-c1">false</span>
            <span class="pl-ent">embedded:</span>
                <span class="pl-ent">content:</span> <span class="pl-s">expr(object.getFriends())</span>
                <span class="pl-ent">xmlElementName:</span> <span class="pl-s">users</span>
                <span class="pl-ent">exclusion:</span> <span class="pl-s">...</span>
            <span class="pl-ent">exclusion:</span>
                <span class="pl-ent">groups:</span> <span class="pl-s">[Default, user_full]</span>
                <span class="pl-ent">since_version:</span> <span class="pl-c1">1.0</span>
                <span class="pl-ent">until_version:</span> <span class="pl-c1">2.2</span>
                <span class="pl-ent">exclude_if:</span> <span class="pl-s">expr(object.getFriends() === null)</span>

    <span class="pl-ent">relation_providers:</span> <span class="pl-s">[ 'Class::getRelations', 'getRelations' ]</span></pre></div>

<h3>
<a id="annotations" class="anchor" href="#annotations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Annotations</h3>

<h4>
<a id="relation" class="anchor" href="#relation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="https://github.com/Relation" class="user-mention">@Relation</a>
</h4>

<p>This annotation can be defined on a class.</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration\Annotation</span> <span class="pl-k">as</span> <span class="pl-c1">Hateoas</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation(</span></span>
<span class="pl-s1"><span class="pl-c"> *     name = "self",</span></span>
<span class="pl-s1"><span class="pl-c"> *     href = "http://hello",</span></span>
<span class="pl-s1"><span class="pl-c"> *     embedded = "expr(object.getHello())",</span></span>
<span class="pl-s1"><span class="pl-c"> *     attributes = { "foo" = "bar" },</span></span>
<span class="pl-s1"><span class="pl-c"> *     exclusion = ...,</span></span>
<span class="pl-s1"><span class="pl-c"> * )</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span></pre></div>

<table>
<thead>
<tr>
<th>Property</th>
<th>Required</th>
<th>Content</th>
<th>Expression language</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>Yes</td>
<td>string</td>
<td>Yes</td>
</tr>
<tr>
<td>href</td>
<td>If embedded is not set</td>
<td>string / <a href="#route">@Route</a>
</td>
<td>Yes</td>
</tr>
<tr>
<td>embedded</td>
<td>If href is not set</td>
<td>string / <a href="#embedded">@Embedded</a>
</td>
<td>Yes</td>
</tr>
<tr>
<td>attributes</td>
<td>No</td>
<td>array</td>
<td>Yes on key and values</td>
</tr>
<tr>
<td>exclusion</td>
<td>No</td>
<td><a href="#exclusion">@Exclusion</a></td>
<td>N/A</td>
</tr>
</tbody>
</table>

<p><strong>Important:</strong> <code>attributes</code> are only used on <strong>link relations</strong> (i.e. combined
with the <code>href</code> property, not with the <code>embedded</code> one).</p>

<h4>
<a id="route" class="anchor" href="#route" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="https://github.com/Route" class="user-mention">@Route</a>
</h4>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration\Annotation</span> <span class="pl-k">as</span> <span class="pl-c1">Hateoas</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation(</span></span>
<span class="pl-s1"><span class="pl-c"> *     name = "self",</span></span>
<span class="pl-s1"><span class="pl-c"> *     href = @Hateoas\Route(</span></span>
<span class="pl-s1"><span class="pl-c"> *         "user_get",</span></span>
<span class="pl-s1"><span class="pl-c"> *         parameters = { "id" = "expr(object.getId())" },</span></span>
<span class="pl-s1"><span class="pl-c"> *         absolute = true,</span></span>
<span class="pl-s1"><span class="pl-c"> *         generator = "my_custom_generator"</span></span>
<span class="pl-s1"><span class="pl-c"> *     )</span></span>
<span class="pl-s1"><span class="pl-c"> * )</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span></pre></div>

<p>This annotation can be defined in the <strong>href</strong> property of the
<a href="#relation">@Relation</a> annotation. This is allows you to your URL generator,
if you have configured one.</p>

<table>
<thead>
<tr>
<th>Property</th>
<th>Required</th>
<th>Content</th>
<th>Expression language</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>Yes</td>
<td>string</td>
<td>Yes</td>
</tr>
<tr>
<td>parameters</td>
<td>Defaults to array()</td>
<td>array / string</td>
<td>Yes (string + array key/values)</td>
</tr>
<tr>
<td>absolute</td>
<td>Defaults to false</td>
<td>boolean / string</td>
<td>Yes</td>
</tr>
<tr>
<td>generator</td>
<td>No</td>
<td>string / null</td>
<td>No</td>
</tr>
</tbody>
</table>

<h4>
<a id="embedded" class="anchor" href="#embedded" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="https://github.com/Embedded" class="user-mention">@Embedded</a>
</h4>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration\Annotation</span> <span class="pl-k">as</span> <span class="pl-c1">Hateoas</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation(</span></span>
<span class="pl-s1"><span class="pl-c"> *     name = "friends",</span></span>
<span class="pl-s1"><span class="pl-c"> *     embedded = @Hateoas\Embedded(</span></span>
<span class="pl-s1"><span class="pl-c"> *         "expr(object.getFriends())",</span></span>
<span class="pl-s1"><span class="pl-c"> *         exclusion = ...,</span></span>
<span class="pl-s1"><span class="pl-c"> *         xmlElementName = "users"</span></span>
<span class="pl-s1"><span class="pl-c"> *     )</span></span>
<span class="pl-s1"><span class="pl-c"> * )</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span></pre></div>

<p>This annotation can be defined in the <strong>embedded</strong> property of the
<a href="#relation">@Relation</a> annotation. It is useful if you need configure the
<code>exclusion</code> or <code>xmlElementName</code> options for the embedded resource.</p>

<table>
<thead>
<tr>
<th>Property</th>
<th>Required</th>
<th>Content</th>
<th>Expression language</th>
</tr>
</thead>
<tbody>
<tr>
<td>content</td>
<td>Yes</td>
<td>string / array</td>
<td>Yes (string)</td>
</tr>
<tr>
<td>exclusion</td>
<td>Defaults to array()</td>
<td><a href="#exclusion">@Exclusion</a></td>
<td>N/A</td>
</tr>
<tr>
<td>xmlElementName</td>
<td>Defaults to array()</td>
<td>string</td>
<td>Yes</td>
</tr>
</tbody>
</table>

<h4>
<a id="exclusion" class="anchor" href="#exclusion" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="https://github.com/Exclusion" class="user-mention">@Exclusion</a>
</h4>

<p>This annotation can be defined in the <strong>exclusion</strong> property of both the
<a href="#relation">@Relation</a> and <a href="#embedded">@Embedded</a> annotations.</p>

<table>
<thead>
<tr>
<th>Property</th>
<th>Required</th>
<th>Content</th>
<th>Expression language</th>
</tr>
</thead>
<tbody>
<tr>
<td>groups</td>
<td>No</td>
<td>array</td>
<td>No</td>
</tr>
<tr>
<td>sinceVersion</td>
<td>No</td>
<td>float / integer</td>
<td>No</td>
</tr>
<tr>
<td>untilVersion</td>
<td>No</td>
<td>float / integer</td>
<td>No</td>
</tr>
<tr>
<td>maxDepth</td>
<td>No</td>
<td>integer</td>
<td>No</td>
</tr>
<tr>
<td>excludeIf</td>
<td>No</td>
<td>string / boolean</td>
<td>Yes</td>
</tr>
</tbody>
</table>

<p>All values except <code>excludeIf</code> act the same way as when they are used directly
on the regular properties with the serializer.</p>

<p><code>excludeIf</code> expects a boolean and is helpful when another expression would fail
under some circumstances. In this example, if the <code>getManager</code> method is <code>null</code>,
you should exclude it to prevent the URL generation from failing:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * @Hateoas\Relation(</span></span>
<span class="pl-s1"><span class="pl-c"> *     "manager",</span></span>
<span class="pl-s1"><span class="pl-c"> *     href = @Hateoas\Route(</span></span>
<span class="pl-s1"><span class="pl-c"> *         "user_get",</span></span>
<span class="pl-s1"><span class="pl-c"> *         parameters = { "id" = "expr(object.getManager().getId())" }</span></span>
<span class="pl-s1"><span class="pl-c"> *     ),</span></span>
<span class="pl-s1"><span class="pl-c"> *     exclusion = @Hateoas\Exclusion(excludeIf = "expr(null === object.getManager())")</span></span>
<span class="pl-s1"><span class="pl-c"> * )</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">User</span></span>
<span class="pl-s1">{</span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">getId</span>() {}</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c">     * <span class="pl-k">@return</span> User|null</span></span>
<span class="pl-s1"><span class="pl-c">     */</span></span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">getManager</span>() {}</span>
<span class="pl-s1">}</span></pre></div>

<h4>
<a id="relationprovider" class="anchor" href="#relationprovider" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>@RelationProvider</h4>

<p>This annotation can be defined on a class.
It is useful if you wish to serialize multiple-relations(links).
As an example:</p>

<pre><code>{
  "_links": {
    "relation_name": [
      {"href": "link1"},
      {"href": "link2"},
      {"href": "link3"}
    ]
  }
}
</code></pre>

<table>
<thead>
<tr>
<th>Property</th>
<th>Required</th>
<th>Content</th>
<th>Expression language</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>Yes</td>
<td>string</td>
<td>No</td>
</tr>
</tbody>
</table>

<p>The property "name" should take the relations-returning method which you have defined in your class ("addRelations" in the following example).</p>

<p>The can be:</p>

<ul>
<li>A method: <code>addRelations</code>
</li>
<li>A static method: <code>Class::addRelations</code>
</li>
<li>A Symfony2 service method: <code>acme_foo.service:addRelations</code>
</li>
</ul>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration\Metadata\ClassMetadataInterface</span>;</span>
<span class="pl-s1"><span class="pl-k">use</span> <span class="pl-c1">Hateoas\Configuration</span> <span class="pl-k">as</span> <span class="pl-c1">Hateoas</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">class</span> <span class="pl-en">MyRelationProvider</span></span>
<span class="pl-s1">{</span>
<span class="pl-s1">    <span class="pl-k">public</span> <span class="pl-k">function</span> <span class="pl-en">addRelations</span>(<span class="pl-smi">$object</span>, <span class="pl-c1">ClassMetadataInterface</span> <span class="pl-smi">$classMetadata</span>)</span>
<span class="pl-s1">    {</span>
<span class="pl-s1">        <span class="pl-c">// You need to return the relations</span></span>
<span class="pl-s1">        <span class="pl-c">// Adding the relations to the $classMetadata won't work</span></span>
<span class="pl-s1">        <span class="pl-k">return</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">            <span class="pl-k">new</span> <span class="pl-c1">Hateoas\</span><span class="pl-c1">Relation</span>(</span>
<span class="pl-s1">                <span class="pl-s"><span class="pl-pds">'</span>self<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                <span class="pl-k">new</span> <span class="pl-c1">Hateoas\</span><span class="pl-c1">Route</span>(</span>
<span class="pl-s1">                    <span class="pl-s"><span class="pl-pds">'</span>foo_get<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">                    <span class="pl-c1">array</span>(<span class="pl-s"><span class="pl-pds">'</span>id<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>expr(object.getId())<span class="pl-pds">'</span></span>)</span>
<span class="pl-s1">                )</span>
<span class="pl-s1">            )</span>
<span class="pl-s1">        );</span>
<span class="pl-s1">    }</span>
<span class="pl-s1">}</span></pre></div>

<h2>
<a id="internals" class="anchor" href="#internals" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Internals</h2>

<p>This section refers to the Hateoas internals, providing documentation about
hidden parts of this library. This is not always relevant for end users, but
interesting for developers or people interested in learning how things work
under the hood.</p>

<h2>
<a id="contributing" class="anchor" href="#contributing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contributing</h2>

<p>See CONTRIBUTING file.</p>

<h2>
<a id="running-the-tests" class="anchor" href="#running-the-tests" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running the Tests</h2>

<p>Install the <a href="http://getcomposer.org/">Composer</a> <code>dev</code> dependencies:</p>

<pre><code>php composer.phar install --dev
</code></pre>

<p>Then, run the test suite using <a href="http://phpunit.de/">PHPUnit</a>:</p>

<pre><code>bin/phpunit
</code></pre>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>

<p>Hateoas is released under the MIT License. See the bundled LICENSE file for
details.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/willdurand/Hateoas">Hateoas</a> is maintained by <a href="https://github.com/willdurand">willdurand</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-46469869-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
